Index: site/src/app/admin/components/release-form.tsx
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>\"use client\";\n\nimport { Link, Release } from \"@/lib/apihelper\";\nimport { Button } from \"@/app/ui/button\";\nimport { getLinks } from \"@/app/actions/getlinks\";\nimport { FormField } from \"@/app/ui/form-field\";\nimport Image from \"next/image\";\nimport React from \"react\";\nimport { createRelease, deleteRelease, updateRelease } from \"@/app/actions/updateRelease\";\nimport { useRouter } from \"next/navigation\";\n\nexport const emptyRelease: Release = {\n  artwork: \"\",\n  slug: \"\",\n  artist_id: \"\",\n  upc: \"\",\n  title: \"\",\n  release_date: \"\",\n  artist_name: \"\",\n  links: [],\n  track_count: 0,\n};\n\nexport const ReleaseForm = ({ release }: { release?: Release }) => {\n  const [editedRelease, setEditedRelease] = React.useState<Release>(\n    release || emptyRelease,\n  );\n\n  const router = useRouter();\n\n  const [status, setStatus] = React.useState<string>(\"\");\n\n  React.useEffect(() => {\n    setEditedRelease(release || emptyRelease);\n  }, [release]);\n\n  React.useEffect(() => {\n    setTimeout(() => {\n      setStatus(\"\");\n    }, 5000);\n  }, [status]);\n\n  const getReleaseUpdater = (field: keyof Release) => {\n    return (value: string | number | Link[]) => {\n      setEditedRelease((prev) => {\n        return {\n          ...prev,\n          [field]: value,\n        } as Release;\n      });\n    };\n  };\n\n  return (\n    <div className={\"flex justify-center max-h-full w-full  text-black \"}>\n      <form\n        className={\"p-4 h-full flex-col flex w-full  \"}\n        onSubmit={(e) => e.preventDefault()}\n      >\n        <FormField\n          name=\"upc\"\n          label=\"UPC\"\n          valueUpdater={getReleaseUpdater(\"upc\")}\n          value={editedRelease.upc || \"\"}\n          button={\n            <Button\n              inline\n              secondary\n              onClick={async () => {\n                const newRelease = await getLinks(editedRelease.upc);\n                setEditedRelease((prev) => {\n                  return {\n                    ...prev,\n                    ...newRelease,\n                  } as Release;\n                });\n              }}\n            >\n              Get Links...\n            </Button>\n          }\n        />\n        <FormField\n          name=\"release-title\"\n          label=\"Release Title\"\n          valueUpdater={getReleaseUpdater(\"title\")}\n          value={editedRelease.title}\n        />\n        <FormField\n          name=\"artist-name\"\n          label=\"Artist Name\"\n          valueUpdater={getReleaseUpdater(\"artist_name\")}\n          value={editedRelease.artist_name || \"\"}\n        />\n        <div className={\"grid grid-cols-2 gap-x-4 grid-flow-row formgrid\"}>\n          <FormField\n            name=\"release-date\"\n            label=\"Release Date\"\n            valueUpdater={getReleaseUpdater(\"release_date\")}\n            value={editedRelease.release_date || \"\"}\n          />\n          <FormField\n            name=\"track-count\"\n            label=\"Track Count\"\n            valueUpdater={getReleaseUpdater(\"track_count\")}\n            value={editedRelease.track_count.toString() || \"\"}\n          />\n          <FormField\n            name=\"slug\"\n            label=\"Slug\"\n            valueUpdater={getReleaseUpdater(\"slug\")}\n            value={editedRelease.slug || \"\"}\n            inactive={!!release?.slug}\n            button={\n              !release?.slug ? (\n                <Button\n                  inline\n                  secondary\n                  onClick={() => {\n                    const slug = editedRelease.title\n                      .split(\" \")\n                      .map(\n                        (word) => word.toLowerCase().replace(/[()'\"]/g, \"\")[0],\n                      )\n                      .join(\"\");\n\n                    getReleaseUpdater(\"slug\")(slug);\n                  }}\n                >\n                  Generate...\n                </Button>\n              ) : (\n                <></>\n              )\n            }\n          />\n          <FormField\n            name=\"artist-id\"\n            label=\"Artist ID\"\n            inactive\n            valueUpdater={getReleaseUpdater(\"artist_id\")}\n            value={editedRelease.artist_id || \"\"}\n          />\n          <FormLinks\n            valueUpdateAction={getReleaseUpdater(\"links\")}\n            links={editedRelease.links || []}\n          />\n          <div>\n            <label\n              htmlFor=\"artwork\"\n              className={\"text-gray-500 font-light text-sm p-0 m-0\"}\n            >\n              Artwork\n            </label>\n            <Image\n              id={\"artwork\"}\n              src={editedRelease.artwork || \"/linkraudio.svg\"}\n              alt={\"Artwork\"}\n              width={200}\n              height={200}\n              className={\"aspect-square h-fit \"}\n            />\n          </div>\n        </div>\n        <div className=\"saveContainer flex-col flex items-end  m-6\">\n          <div>\n            <Button\n              secondary\n              name={\"delete\"}\n              className={\"mr-4\"}\n              onClick={async () => {\n                const result = await deleteRelease(editedRelease);\n\n                if (result.success) {\n                  setStatus(\"Successfully deleted release.\");\n                } else {\n                  setStatus(result.error!);\n                }\n                router.refresh();\n              }}\n            >\n              Delete\n            </Button>\n            <Button\n              name={\"save\"}\n              onClick={async () => {\n                const result = !!release?.slug\n                  ? await updateRelease(editedRelease)\n                  : await createRelease(editedRelease);\n                if (result.success) {\n                  setStatus(\"Successfully saved release.\");\n                } else {\n                  setStatus(result.error!);\n                }\n\n                router.refresh();\n                return;\n              }}\n            >\n              Save\n            </Button>\n          </div>\n          {status != \"\" && (\n            <p\n              className={\n                \"text-right bg-rose-50 rounded-md p-4 m-4 absolute left-4 bottom-0\"\n              }\n            >\n              {status}\n            </p>\n          )}\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport const FormLinks = ({\n  links,\n  valueUpdateAction,\n}: {\n  links: Link[];\n  valueUpdateAction: (value: Link[]) => void;\n}) => {\n  const getLinkUpdater = (i: number, key: keyof Link) => (value: string) => {\n    const newLinks = links;\n    newLinks[i][key] = value;\n    valueUpdateAction(newLinks);\n  };\n\n  const linkFields = links.map((link, i) => {\n    return (\n      <div key={i} className={\"flex flex-col m-2  p-2 bg-gray-50 rounded-lg\"}>\n        <FormField\n          name={\"name\" + i}\n          label={\"Name\"}\n          valueUpdater={getLinkUpdater(i, \"name\")}\n          value={link.name}\n          button={\n            <Button\n              className={\"\"}\n              inline\n              secondary\n              onClick={() => valueUpdateAction(links.filter((_, j) => j !== i))}\n            >\n              Remove\n            </Button>\n          }\n        />\n        <FormField\n          name={\"url\" + i}\n          label={\"URL\"}\n          valueUpdater={getLinkUpdater(i, \"url\")}\n          value={link.url}\n        />\n      </div>\n    );\n  });\n\n  return (\n    <div className={\"\"}>\n      <label\n        htmlFor=\"links\"\n        className={\"text-gray-500 font-light text-sm p-0 m-0\"}\n      >\n        Links\n      </label>\n      <div id=\"links\" className={\"bg-gray-100 p-1 h-full\"}>\n        {linkFields}\n        <Button\n          onClick={() => {\n            valueUpdateAction([...links, { name: \"\", url: \"\" }]);\n          }}\n        >\n          +\n        </Button>\n      </div>\n    </div>\n  );\n};\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/site/src/app/admin/components/release-form.tsx b/site/src/app/admin/components/release-form.tsx
--- a/site/src/app/admin/components/release-form.tsx	(revision 1631ab16ff7d773a570a820f4ca4ee831a4cef06)
+++ b/site/src/app/admin/components/release-form.tsx	(date 1766835466784)
@@ -6,7 +6,11 @@
 import { FormField } from "@/app/ui/form-field";
 import Image from "next/image";
 import React from "react";
-import { createRelease, deleteRelease, updateRelease } from "@/app/actions/updateRelease";
+import {
+  createRelease,
+  deleteRelease,
+  updateRelease,
+} from "@/app/actions/updateRelease";
 import { useRouter } from "next/navigation";
 
 export const emptyRelease: Release = {
